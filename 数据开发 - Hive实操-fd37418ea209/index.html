<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>数据开发 - Hive实操 | 妙妙屋</title><meta name="author" content="吴秋旭"><meta name="copyright" content="吴秋旭"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="一、Hive安装部署1、下载安装下载地址：http:&#x2F;&#x2F;archive.apache.org&#x2F;dist&#x2F;hive&#x2F; 官方文档：https:&#x2F;&#x2F;cwiki.apache.org&#x2F;confluence&#x2F;display&#x2F;Hive&#x2F;Home#Home-HiveDocumentation  解压安装：tar -zxf &#x2F;opt&#x2F;software&#x2F;zookeeper-3.5.7 -C &#x2F;opt&#x2F;module&#x2F;">
<meta property="og:type" content="article">
<meta property="og:title" content="数据开发 - Hive实操">
<meta property="og:url" content="https://wuqiuxu.github.io/%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91%20-%20Hive%E5%AE%9E%E6%93%8D-fd37418ea209/index.html">
<meta property="og:site_name" content="妙妙屋">
<meta property="og:description" content="一、Hive安装部署1、下载安装下载地址：http:&#x2F;&#x2F;archive.apache.org&#x2F;dist&#x2F;hive&#x2F; 官方文档：https:&#x2F;&#x2F;cwiki.apache.org&#x2F;confluence&#x2F;display&#x2F;Hive&#x2F;Home#Home-HiveDocumentation  解压安装：tar -zxf &#x2F;opt&#x2F;software&#x2F;zookeeper-3.5.7 -C &#x2F;opt&#x2F;module&#x2F;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wuqiuxu.github.io/img/avatar.png">
<meta property="article:published_time" content="2023-06-24T07:02:08.000Z">
<meta property="article:modified_time" content="2024-05-06T06:21:36.069Z">
<meta property="article:author" content="吴秋旭">
<meta property="article:tag" content="Hive">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wuqiuxu.github.io/img/avatar.png"><link rel="shortcut icon" href="/img/Psyduck.png"><link rel="canonical" href="https://wuqiuxu.github.io/%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91%20-%20Hive%E5%AE%9E%E6%93%8D-fd37418ea209/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"V9Z0XHM9DP","apiKey":"fa27b7a048b6171f01dadf98cba8a3fd","indexName":"blog","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: 吴秋旭","link":"链接: ","source":"来源: 妙妙屋","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '数据开发 - Hive实操',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-05-06 14:21:36'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">57</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">29</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 最新文章</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa-solid fa-screwdriver-wrench"></i><span> 文档&amp;工具</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url('/img/default.png')"><nav id="nav"><span id="blog-info"><a href="/" title="妙妙屋"><img class="site-icon" src="/img/Psyduck.png"/><span class="site-name">妙妙屋</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 最新文章</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa-solid fa-screwdriver-wrench"></i><span> 文档&amp;工具</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">数据开发 - Hive实操</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-06-24T07:02:08.000Z" title="发表于 2023-06-24 15:02:08">2023-06-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-05-06T06:21:36.069Z" title="更新于 2024-05-06 14:21:36">2024-05-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91/">数据开发</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="数据开发 - Hive实操"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="一、Hive安装部署"><a href="#一、Hive安装部署" class="headerlink" title="一、Hive安装部署"></a>一、Hive安装部署</h1><h2 id="1、下载安装"><a href="#1、下载安装" class="headerlink" title="1、下载安装"></a>1、下载安装</h2><p>下载地址：<a target="_blank" rel="noopener" href="http://archive.apache.org/dist/hive/">http://archive.apache.org/dist/hive/</a></p>
<p>官方文档：<a target="_blank" rel="noopener" href="https://cwiki.apache.org/confluence/display/Hive/Home#Home-HiveDocumentation">https://cwiki.apache.org/confluence/display/Hive/Home#Home-HiveDocumentation</a></p>
<ol>
<li>解压安装：<code>tar -zxf /opt/software/zookeeper-3.5.7 -C /opt/module/</code></li>
<li>解决jar冲突问题：将lib目录下的<code>log4j-slf4j-impl-2.10.0.jar</code>重命名</li>
<li>配置并生效环境变量</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#HIVE_HOME</span></span><br><span class="line"><span class="built_in">export</span> HIVE_HOME=/opt/module/hive-3.1.2</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HIVE_HOME</span>/bin</span><br></pre></td></tr></table></figure>

<h2 id="2、配置文件"><a href="#2、配置文件" class="headerlink" title="2、配置文件"></a>2、配置文件</h2><p>修改以下Hadoop配置文件，分发并重启集群</p>
<h3 id="1-修改core-site-xml"><a href="#1-修改core-site-xml" class="headerlink" title="1. 修改core-site.xml"></a>1. 修改core-site.xml</h3><ul>
<li>命令：<code>vim /opt/module/hadoop/etc/hadoop/core-site.xml</code></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置该atguigu(superUser)允许通过代理访问的主机节点 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.proxyuser.atguigu.hosts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 配置该atguigu(superUser)允许通过代理用户所属组 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.proxyuser.atguigu.groups<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 配置该atguigu(superUser)允许通过代理的用户--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.proxyuser.atguigu.users<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-修改yarn-site-xml"><a href="#2-修改yarn-site-xml" class="headerlink" title="2. 修改yarn-site.xml"></a>2. 修改yarn-site.xml</h3><ul>
<li>命令：<code>vim /opt/module/hadoop/etc/hadoop/yarn-site.xml</code></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- NodeManager使用内存数，默认8G，修改为4G内存（16g物理内存的改为2g或者是3g） --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Amount of physical memory, in MB, that can be allocated </span><br><span class="line">        for containers. If set to -1 and</span><br><span class="line">        yarn.nodemanager.resource.detect-hardware-capabilities is true, it is</span><br><span class="line">        automatically calculated(in case of Windows and Linux).</span><br><span class="line">        In other cases, the default is 8192MB.</span><br><span class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.resource.memory-mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>4096<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 容器最小内存，默认512M --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>The minimum allocation for every container request at the RM        in MBs. </span><br><span class="line">            Memory requests lower than this will be set to the value of this        property. </span><br><span class="line">            Additionally, a node manager that is configured to have less memory        than this value</span><br><span class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.minimum-allocation-mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>512<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 容器最大内存，默认8G，修改为4G --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>The maximum allocation for every container request at the RM        in MBs. </span><br><span class="line">            Memory requests higher than this will throw an        InvalidResourceRequestException.</span><br><span class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.maximum-allocation-mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>4096<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 虚拟内存检查，默认打开，修改为关闭（使用虚拟内存） --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Whether virtual memory limits will be enforced for containers.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.vmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="3、元数据部署"><a href="#3、元数据部署" class="headerlink" title="3、元数据部署"></a>3、元数据部署</h2><ol>
<li><h3 id="部署Derby"><a href="#部署Derby" class="headerlink" title="部署Derby"></a>部署Derby</h3></li>
</ol>
<p>初始化Derby数据库：<code>schematool -dbType derby -initSchema</code></p>
<ol>
<li><h3 id="部署MySQL"><a href="#部署MySQL" class="headerlink" title="部署MySQL"></a>部署MySQL</h3></li>
<li><p>检查当前系统是否安装过Mysql：<code>rpm -qa|grep mariadb</code></p>
<ol>
<li>存在则移除：<code>rpm -e --nodeps mariadb-libs</code></li>
<li>不存在则忽略</li>
</ol>
</li>
<li><p>解压rpm安装包：<code>tar -xf /opt/software/mysql-5.7.28-1.el7.x86_64.rpm-bundle.tar -C /opt/software/mysql_jars</code></p>
</li>
</ol>
<p><img src="https://r19unqg14el.feishu.cn/space/api/box/stream/download/asynccode/?code=MzkyZTFlZDFmNDU0YWUzNGJjYjJlMDQwODQ4Y2M2NzVfb21yZURMTHRIVFpvV3lRYWJxRVAxTHZPVjVZZEhUNWlfVG9rZW46SlVyYWJJckdob1NkdGR4bHFFdGNrZXltblZkXzE2ODc1ODMxNzE6MTY4NzU4Njc3MV9WNA" alt="img"></p>
<ol>
<li><p>按照如下顺序执行rpm安装</p>
<ol>
<li><code>sudo rpm -ivh mysql-community-common-5.7.28-1.el7.x86_64.rpm</code></li>
<li><code>sudo rpm -ivh mysql-community-libs-5.7.28-1.el7.x86_64.rpm</code></li>
<li><code>sudo rpm -ivh mysql-community-libs-compat-5.7.28-1.el7.x86_64.rpm</code></li>
<li><code>sudo rpm -ivh mysql-community-client-5.7.28-1.el7.x86_64.rpm</code></li>
<li><code>sudo rpm -ivh mysql-community-server-5.7.28-1.el7.x86_64.rpm</code></li>
</ol>
</li>
<li><p>删除mysql的数据存储路径下的所有内容（路径地址：&#x2F;etc&#x2F;my.cnf文件中datadir参数所对应的值）：<code>rm -rf ./*</code> </p>
</li>
<li><p>初始化MySQL数据库：<code>sudo mysqld --initialize --user=mysql</code></p>
<ol>
<li>启动MySQL服务：<code>sudo systemctl start mysqld</code></li>
<li>登录MySQL数据库（密码为刚刚生成的临时密码）：<code>mysql -uroot -p</code></li>
<li>修改密码：<code>set password = password(&quot;新密码&quot;);</code></li>
<li>修改mysql库的user表：<code>update mysql.user set host=&#39;%&#39; where user=&#39;root&#39;;</code></li>
<li>刷新：<code>flush privileges;</code></li>
</ol>
</li>
<li><p>配置Hive元数据库为MySQL</p>
<ol>
<li><p>拷贝JDBC驱动：<code>cp mysql-connector-java-5.1.37.jar ./lib</code></p>
</li>
<li><p>配置Metastore到MySQL（在conf目录下新建hive-site.xml文件）：<code>vim ./conf/hive-site.xml</code></p>
</li>
<li><pre><code class="XML">&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;
&lt;configuration&gt;
    &lt;!-- jdbc连接的URL --&gt;
    &lt;property&gt;
        &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;
        &lt;value&gt;jdbc:mysql://hadoop102:3306/metastore?useSSL=false&lt;/value&gt;
    &lt;/property&gt;
    &lt;!-- jdbc连接的Driver--&gt;
    &lt;property&gt;
        &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;
        &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;
    &lt;/property&gt;
    &lt;!-- jdbc连接的username--&gt;
    &lt;property&gt;
        &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;
        &lt;value&gt;root&lt;/value&gt;
    &lt;/property&gt;
    &lt;!-- jdbc连接的password --&gt;
    &lt;property&gt;
        &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;
        &lt;value&gt;123456&lt;/value&gt;
    &lt;/property&gt;
    &lt;!-- Hive默认在HDFS的工作目录 --&gt;
    &lt;property&gt;
        &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt;
        &lt;value&gt;/user/hive/warehouse&lt;/value&gt;
    &lt;/property&gt;
    &lt;!-- Hive元数据存储的验证 --&gt;
    &lt;property&gt;
        &lt;name&gt;hive.metastore.schema.verification&lt;/name&gt;
        &lt;value&gt;false&lt;/value&gt;
    &lt;/property&gt;
    
    &lt;property&gt;
    &lt;name&gt;hive.server2.thrift.port&lt;/name&gt;
    &lt;value&gt;10000&lt;/value&gt;
    &lt;/property&gt;
 
    &lt;property&gt;
        &lt;name&gt;hive.server2.thrift.bind.host&lt;/name&gt;
        &lt;value&gt;hadoop102&lt;/value&gt;
    &lt;/property&gt;
    
    &lt;!-- 元数据存储授权  --&gt;
    &lt;property&gt;
        &lt;name&gt;hive.metastore.event.db.notification.api.auth&lt;/name&gt;
        &lt;value&gt;false&lt;/value&gt;
    &lt;/property&gt;
    
    &lt;property&gt;
        &lt;name&gt;hive.cli.print.header&lt;/name&gt;
        &lt;value&gt;true&lt;/value&gt;
    &lt;/property&gt;
 
    &lt;property&gt;
        &lt;name&gt;hive.cli.print.current.db&lt;/name&gt;
        &lt;value&gt;true&lt;/value&gt;
    &lt;/property&gt;

&lt;/configuration&gt;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">5. 初始化元数据库</span><br><span class="line"></span><br><span class="line">   1. 登录MySQL：`mysql -uroot -p`</span><br><span class="line">   2. 新建Hive元数据库：`create database metastore;`</span><br><span class="line">   3. 初始化Hive元数据库：`schematool -initSchema -dbType mysql -verbose`</span><br><span class="line"></span><br><span class="line">6. ### 部署MetaStore Server</span><br><span class="line"></span><br><span class="line">在部署MySQL的基础上修改配置</span><br><span class="line"></span><br><span class="line">在hive-site.xml文件中添加配置信息：`vim conf/hive-site.xml`</span><br><span class="line"></span><br><span class="line">```XML</span><br><span class="line">&lt;!-- 指定存储元数据要连接的地址 --&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;hive.metastore.uris&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;thrift://hadoop102:9083&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- hiveserver2配置 --&gt;</span><br><span class="line">&lt;!-- 指定hiveserver2连接的host --&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;hive.server2.thrift.bind.host&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;hadoop102&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;!-- 指定hiveserver2连接的端口号 --&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;hive.server2.thrift.port&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;10000&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ol>
</li>
</ol>
<h1 id="二、Hive启动-停止"><a href="#二、Hive启动-停止" class="headerlink" title="二、Hive启动&#x2F;停止"></a>二、Hive启动&#x2F;停止</h1><p>命令行方式访问只需启动MetaStore服务</p>
<ol>
<li>启动MetaStore服务：<code>hive --service metastore</code></li>
<li>启动HiveServer2服务：<code>hive --service hiveserver2</code></li>
</ol>
<h1 id="三、Hive操作"><a href="#三、Hive操作" class="headerlink" title="三、Hive操作"></a>三、Hive操作</h1><h2 id="1、命令行"><a href="#1、命令行" class="headerlink" title="1、命令行"></a>1、命令行</h2><ul>
<li>查看命令帮助：<code>hive -help</code></li>
</ul>
<table>
<thead>
<tr>
<th>常用选项</th>
<th>作用</th>
<th>举例</th>
</tr>
</thead>
<tbody><tr>
<td>-d</td>
<td>应用于hive命令的变量替换</td>
<td></td>
</tr>
<tr>
<td>–database</td>
<td>指定要使用的数据库</td>
<td></td>
</tr>
<tr>
<td>-e</td>
<td>命令行中的SQL语句</td>
<td><code>hive -e &quot;select * from test2;&quot;</code></td>
</tr>
<tr>
<td>-f</td>
<td>文件中的SQL语句</td>
<td><code>hive -f /opt/module/hive/datas/hivef.sql</code></td>
</tr>
<tr>
<td>-H</td>
<td>打印帮助信息</td>
<td></td>
</tr>
<tr>
<td>–hiveconf</td>
<td>设置属性值</td>
<td></td>
</tr>
<tr>
<td>–hivevar</td>
<td>应用于hive命令的变量替换</td>
<td></td>
</tr>
<tr>
<td>-i</td>
<td>初始化SQL文件</td>
<td></td>
</tr>
<tr>
<td>-S</td>
<td>交互式Shell中的静默模式</td>
<td></td>
</tr>
<tr>
<td>-v</td>
<td>详细模式（将执行的SQl回显到控制台）</td>
<td></td>
</tr>
</tbody></table>
<h2 id="2、HiveServer2"><a href="#2、HiveServer2" class="headerlink" title="2、HiveServer2"></a>2、HiveServer2</h2><ul>
<li>查看命令帮助：<code>beeline -help</code></li>
</ul>
<table>
<thead>
<tr>
<th>常用选项</th>
<th>作用</th>
<th>举例</th>
</tr>
</thead>
<tbody><tr>
<td>-u</td>
<td>JDBC连接地址</td>
<td><code>beeline -u jdbc:hive2://hadoop102:10000 -n wuqiuxu</code></td>
</tr>
<tr>
<td>-n</td>
<td>JDBC连接用户名</td>
<td></td>
</tr>
</tbody></table>
<h1 id="四、Hive客户端操作（HQL）"><a href="#四、Hive客户端操作（HQL）" class="headerlink" title="四、Hive客户端操作（HQL）"></a>四、Hive客户端操作（HQL）</h1><p>启动本地客户端：命令行</p>
<p>启动远程客户端：HiveServer2（JDBC连接）</p>
<h2 id="1、数据库配置"><a href="#1、数据库配置" class="headerlink" title="1、数据库配置"></a>1、数据库配置</h2><p>查看当前所有配置信息：<code>set;</code></p>
<h2 id="2、DDL-数据定义"><a href="#2、DDL-数据定义" class="headerlink" title="2、DDL 数据定义"></a>2、DDL 数据定义</h2><h3 id="数据库操作"><a href="#数据库操作" class="headerlink" title="数据库操作"></a>数据库操作</h3><h4 id="创建数据库-CREATE"><a href="#创建数据库-CREATE" class="headerlink" title="创建数据库 CREATE"></a>创建数据库 CREATE</h4><ul>
<li>默认存储路径：&#x2F;user&#x2F;hive&#x2F;warehouse&#x2F;*.db</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [REMOTE] (DATABASE<span class="operator">|</span>SCHEMA) [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] database_name</span><br><span class="line">  [COMMENT database_comment]</span><br><span class="line">  [LOCATION hdfs_path]</span><br><span class="line">  [MANAGEDLOCATION hdfs_path]</span><br><span class="line">  [<span class="keyword">WITH</span> DBPROPERTIES (property_name<span class="operator">=</span>property_value, ...)];</span><br></pre></td></tr></table></figure>

<h4 id="设置数据库-ALTER-SET"><a href="#设置数据库-ALTER-SET" class="headerlink" title="设置数据库 ALTER .. SET .."></a>设置数据库 ALTER .. SET ..</h4><ul>
<li>数据库其他的元数据信息都是不可以修改的，包括数据库名和数据库所在的目录位置</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> (DATABASE<span class="operator">|</span>SCHEMA) database_name <span class="keyword">SET</span> DBPROPERTIES (property_name<span class="operator">=</span>property_value, ...);   <span class="comment">-- (<span class="doctag">Note:</span> SCHEMA added in Hive 0.14.0)</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">ALTER</span> (DATABASE<span class="operator">|</span>SCHEMA) database_name <span class="keyword">SET</span> OWNER [<span class="keyword">USER</span><span class="operator">|</span>ROLE] user_or_role;   <span class="comment">-- (<span class="doctag">Note:</span> Hive 0.13.0 and later; SCHEMA added in Hive 0.14.0)</span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">ALTER</span> (DATABASE<span class="operator">|</span>SCHEMA) database_name <span class="keyword">SET</span> LOCATION hdfs_path; <span class="comment">-- (<span class="doctag">Note:</span> Hive 2.2.1, 2.4.0 and later)</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">ALTER</span> (DATABASE<span class="operator">|</span>SCHEMA) database_name <span class="keyword">SET</span> MANAGEDLOCATION hdfs_path; <span class="comment">-- (<span class="doctag">Note:</span> Hive 4.0.0 and later)</span></span><br></pre></td></tr></table></figure>

<h4 id="切换数据库-USE"><a href="#切换数据库-USE" class="headerlink" title="切换数据库 USE"></a>切换数据库 USE</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">USE database_name;</span><br><span class="line">USE <span class="keyword">DEFAULT</span>;</span><br></pre></td></tr></table></figure>

<h4 id="删除数据库-DROP"><a href="#删除数据库-DROP" class="headerlink" title="删除数据库 DROP"></a>删除数据库 DROP</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> (DATABASE<span class="operator">|</span>SCHEMA) [IF <span class="keyword">EXISTS</span>] database_name [RESTRICT<span class="operator">|</span>CASCADE];</span><br></pre></td></tr></table></figure>

<h3 id="数据表操作"><a href="#数据表操作" class="headerlink" title="数据表操作"></a>数据表操作</h3><h4 id="创建表-CREATE"><a href="#创建表-CREATE" class="headerlink" title="创建表 CREATE"></a>创建表 CREATE</h4><p>默认将表名作为HDFS上表对应的存储路径的名字，但通过localtion指定存储路径，就不会修改路径名字为表名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [TEMPORARY] [<span class="keyword">EXTERNAL</span>] <span class="keyword">TABLE</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] [db_name.]table_name    <span class="comment">-- (<span class="doctag">Note:</span> TEMPORARY available in Hive 0.14.0 and later)</span></span><br><span class="line">  [(col_name data_type [column_constraint_specification] [COMMENT col_comment], ... [constraint_specification])]</span><br><span class="line">  [COMMENT table_comment]</span><br><span class="line">  [PARTITIONED <span class="keyword">BY</span> (col_name data_type [COMMENT col_comment], ...)]</span><br><span class="line">  [CLUSTERED <span class="keyword">BY</span> (col_name, col_name, ...) [SORTED <span class="keyword">BY</span> (col_name [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>], ...)] <span class="keyword">INTO</span> num_buckets BUCKETS]</span><br><span class="line">  [SKEWED <span class="keyword">BY</span> (col_name, col_name, ...)                  <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.10.0 and later)]</span></span><br><span class="line">     <span class="keyword">ON</span> ((col_value, col_value, ...), (col_value, col_value, ...), ...)</span><br><span class="line">     [STORED <span class="keyword">AS</span> DIRECTORIES]</span><br><span class="line">  [</span><br><span class="line">   [<span class="type">ROW</span> FORMAT row_format] </span><br><span class="line">   [STORED <span class="keyword">AS</span> file_format]</span><br><span class="line">     <span class="operator">|</span> STORED <span class="keyword">BY</span> <span class="string">&#x27;storage.handler.class.name&#x27;</span> [<span class="keyword">WITH</span> SERDEPROPERTIES (...)]  <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.6.0 and later)</span></span><br><span class="line">  ]</span><br><span class="line">  [LOCATION hdfs_path]</span><br><span class="line">  [TBLPROPERTIES (property_name<span class="operator">=</span>property_value, ...)]   <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.6.0 and later)</span></span><br><span class="line">  [<span class="keyword">AS</span> select_statement];   <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.5.0 and later; not supported for external tables)</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">CREATE</span> [TEMPORARY] [<span class="keyword">EXTERNAL</span>] <span class="keyword">TABLE</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] [db_name.]table_name</span><br><span class="line">  <span class="keyword">LIKE</span> existing_table_or_view_name</span><br><span class="line">  [LOCATION hdfs_path];</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ROW FORMAT DELIMITED </span></span><br><span class="line">DELIMITED </span><br><span class="line">[FIELDS TERMINATED <span class="keyword">BY</span> <span class="type">char</span> [ESCAPED <span class="keyword">BY</span> <span class="type">char</span>]] </span><br><span class="line">[COLLECTION ITEMS TERMINATED <span class="keyword">BY</span> <span class="type">char</span>]</span><br><span class="line">[MAP KEYS TERMINATED <span class="keyword">BY</span> <span class="type">char</span>] </span><br><span class="line">[LINES TERMINATED <span class="keyword">BY</span> <span class="type">char</span>]</span><br><span class="line">[<span class="keyword">NULL</span> DEFINED <span class="keyword">AS</span> <span class="type">char</span>]   <span class="comment">-- (<span class="doctag">Note:</span> Available in Hive 0.13 and later)</span></span><br><span class="line">  <span class="operator">|</span> SERDE serde_name [<span class="keyword">WITH</span> SERDEPROPERTIES (property_name<span class="operator">=</span>property_value, property_name<span class="operator">=</span>property_value, ...)]</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th><strong>字段</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>CREATE TABLE</td>
<td>创建表</td>
</tr>
<tr>
<td>EXTERNAL</td>
<td>创建外部表</td>
</tr>
<tr>
<td>COMMENT</td>
<td>为表和列添加注释</td>
</tr>
<tr>
<td>PARTITIONED BY</td>
<td>创建分区表</td>
</tr>
<tr>
<td>CLUSTERED BY</td>
<td>创建分桶表</td>
</tr>
<tr>
<td>SORTED BY</td>
<td>对桶中的一个或多个列另外排序</td>
</tr>
<tr>
<td>ROW   FORMAT</td>
<td>Fields：指定字段之间的分隔符Collection：指定集合中元素间的分隔符Map：指定map集合中键值对间的分隔符Lines：指定每行记录间的分隔符SerDe：Serialize&#x2F;Deserialize的简称，若未指定Row Format，则用自带的SerDe</td>
</tr>
<tr>
<td>STORE AS</td>
<td>指定存储文件类型</td>
</tr>
<tr>
<td>LOCATION</td>
<td>指定表在HDFS上的存储位置</td>
</tr>
<tr>
<td>AS</td>
<td>根据查询语句结果创建表</td>
</tr>
<tr>
<td>LIKE</td>
<td>复制现有的表结构，但是不复制数据</td>
</tr>
</tbody></table>
<h4 id="修改表-ALTER-TABLE"><a href="#修改表-ALTER-TABLE" class="headerlink" title="修改表 ALTER TABLE"></a>修改表 ALTER TABLE</h4><h5 id="更新表属性（set）"><a href="#更新表属性（set）" class="headerlink" title="更新表属性（set）"></a>更新表属性（set）</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">SET</span> TBLPROPERTIES table_properties;</span><br></pre></td></tr></table></figure>

<h5 id="重命名表（rename-to）"><a href="#重命名表（rename-to）" class="headerlink" title="重命名表（rename to）"></a>重命名表（rename to）</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name RENAME <span class="keyword">TO</span> new_table_name;</span><br></pre></td></tr></table></figure>

<h5 id="更新列（change）"><a href="#更新列（change）" class="headerlink" title="更新列（change）"></a>更新列（change）</h5><ul>
<li>可更新列名&#x2F;类型&#x2F;位置&#x2F;注释</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name [<span class="keyword">PARTITION</span> partition_spec] CHANGE [<span class="keyword">COLUMN</span>] col_old_name col_new_name column_type</span><br><span class="line">  [COMMENT col_comment] [<span class="keyword">FIRST</span><span class="operator">|</span>AFTER column_name] [CASCADE<span class="operator">|</span>RESTRICT];</span><br></pre></td></tr></table></figure>

<h5 id="增加-替换列（add-replace）"><a href="#增加-替换列（add-replace）" class="headerlink" title="增加&#x2F;替换列（add &#x2F; replace）"></a>增加&#x2F;替换列（add &#x2F; replace）</h5><ul>
<li>增加列：字段位置在所有列后面，partition列前</li>
<li>替换列：表示替换表中所有字段，即可更新列、增加列、删除列</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name </span><br><span class="line">  [<span class="keyword">PARTITION</span> partition_spec]                 <span class="comment">-- (<span class="doctag">Note:</span> Hive 0.14.0 and later)</span></span><br><span class="line">  <span class="keyword">ADD</span><span class="operator">|</span>REPLACE COLUMNS (col_name data_type [COMMENT col_comment], ...)</span><br><span class="line">  [CASCADE<span class="operator">|</span>RESTRICT]                         <span class="comment">-- (<span class="doctag">Note:</span> Hive 1.1.0 and later)</span></span><br></pre></td></tr></table></figure>

<h5 id="清空表（truncate）"><a href="#清空表（truncate）" class="headerlink" title="清空表（truncate）"></a>清空表（truncate）</h5><ul>
<li>只能删除管理表，不能删除外部表中数据</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">TRUNCATE</span> [<span class="keyword">TABLE</span>] table_name [<span class="keyword">PARTITION</span> partition_spec];</span><br></pre></td></tr></table></figure>

<h5 id="删除表（drop）"><a href="#删除表（drop）" class="headerlink" title="删除表（drop）"></a>删除表（drop）</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> [IF <span class="keyword">EXISTS</span>] table_name [PURGE];     <span class="comment">-- (<span class="doctag">Note:</span> PURGE available in Hive 0.14.0 and later)</span></span><br></pre></td></tr></table></figure>

<h5 id="修改分区"><a href="#修改分区" class="headerlink" title="修改分区"></a>修改分区</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 新增分区</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">ADD</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] <span class="keyword">PARTITION</span> partition_spec [LOCATION <span class="string">&#x27;location&#x27;</span>][, <span class="keyword">PARTITION</span> partition_spec [LOCATION <span class="string">&#x27;location&#x27;</span>], ...];</span><br><span class="line"><span class="comment">-- 重命名分区</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">PARTITION</span> partition_spec RENAME <span class="keyword">TO</span> <span class="keyword">PARTITION</span> partition_spec;</span><br><span class="line"><span class="comment">-- 删除分区</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">DROP</span> [IF <span class="keyword">EXISTS</span>] <span class="keyword">PARTITION</span> partition_spec[, <span class="keyword">PARTITION</span> partition_spec, ...]</span><br><span class="line">  [IGNORE PROTECTION] [PURGE];</span><br></pre></td></tr></table></figure>

<h4 id="查询表-SELECT"><a href="#查询表-SELECT" class="headerlink" title="查询表 SELECT"></a>查询表 SELECT</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">WITH</span> CommonTableExpression (, CommonTableExpression)<span class="operator">*</span>]    (Note: <span class="keyword">Only</span> available starting <span class="keyword">with</span> Hive <span class="number">0.13</span><span class="number">.0</span>)</span><br><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span> <span class="operator">|</span> <span class="keyword">DISTINCT</span>] select_expr, select_expr, ...</span><br><span class="line">  <span class="keyword">FROM</span> table_reference</span><br><span class="line">  [<span class="keyword">WHERE</span> where_condition]</span><br><span class="line">  [<span class="keyword">GROUP</span> <span class="keyword">BY</span> col_list]</span><br><span class="line">  [<span class="keyword">ORDER</span> <span class="keyword">BY</span> col_list]</span><br><span class="line">  [CLUSTER <span class="keyword">BY</span> col_list</span><br><span class="line">    <span class="operator">|</span> [DISTRIBUTE <span class="keyword">BY</span> col_list] [SORT <span class="keyword">BY</span> col_list]</span><br><span class="line">  ]</span><br><span class="line"> [LIMIT [<span class="keyword">offset</span>,] <span class="keyword">rows</span>]</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th><strong>顺序</strong></th>
<th><strong>书写次序</strong></th>
<th><strong>执行次序</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>1</strong></td>
<td>select</td>
<td>from</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>distinct</td>
<td>on</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>from</td>
<td>join</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>join</td>
<td>where</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>on</td>
<td>group by</td>
</tr>
<tr>
<td><strong>6</strong></td>
<td>where</td>
<td>having</td>
</tr>
<tr>
<td><strong>7</strong></td>
<td>group by</td>
<td>select</td>
</tr>
<tr>
<td><strong>8</strong></td>
<td>having</td>
<td>distinct</td>
</tr>
<tr>
<td><strong>9</strong></td>
<td>distribute bycluster by</td>
<td>distribute by cluster by</td>
</tr>
<tr>
<td><strong>10</strong></td>
<td>sort by</td>
<td>sort by</td>
</tr>
<tr>
<td><strong>11</strong></td>
<td>order by</td>
<td>order by</td>
</tr>
<tr>
<td><strong>12</strong></td>
<td>limit</td>
<td>limit</td>
</tr>
<tr>
<td><strong>13</strong></td>
<td>union&#x2F;union all</td>
<td>union &#x2F;union all</td>
</tr>
</tbody></table>
<h3 id="Show"><a href="#Show" class="headerlink" title="Show"></a>Show</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Show Databases/Tables/Columns/Views/Materialized Views/Partitions/Indexes/Functions..</span></span><br><span class="line"><span class="keyword">SHOW</span> (DATABASES<span class="operator">|</span>SCHEMAS) [<span class="keyword">LIKE</span> <span class="string">&#x27;identifier_with_wildcards&#x27;</span>];</span><br><span class="line"><span class="keyword">SHOW</span> COLUMNS (<span class="keyword">FROM</span><span class="operator">|</span><span class="keyword">IN</span>) table_name [(<span class="keyword">FROM</span><span class="operator">|</span><span class="keyword">IN</span>) db_name]; </span><br><span class="line"><span class="keyword">SHOW</span> TABLES [<span class="keyword">IN</span> database_name] [<span class="string">&#x27;identifier_with_wildcards&#x27;</span>];</span><br><span class="line"><span class="keyword">SHOW</span> VIEWS [<span class="keyword">IN</span><span class="operator">/</span><span class="keyword">FROM</span> database_name] [<span class="keyword">LIKE</span> <span class="string">&#x27;pattern_with_wildcards&#x27;</span>];</span><br><span class="line"><span class="keyword">SHOW</span> PARTITIONS table_name;</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> ([db_name.]table_name<span class="operator">|</span>view_name);</span><br><span class="line"><span class="keyword">SHOW</span> FUNCTIONS [<span class="keyword">LIKE</span> &quot;&lt;pattern&gt;&quot;];</span><br><span class="line">..</span><br></pre></td></tr></table></figure>

<h3 id="Describe"><a href="#Describe" class="headerlink" title="Describe"></a>Describe</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Describe Database/Table/View/Materialized View/Column/Partition..</span></span><br><span class="line"><span class="keyword">DESCRIBE</span> DATABASE [EXTENDED] db_name;</span><br><span class="line"><span class="keyword">DESCRIBE</span> SCHEMA [EXTENDED] db_name;     <span class="comment">-- (<span class="doctag">Note:</span> Hive 1.1.0 and later)</span></span><br><span class="line"><span class="keyword">DESCRIBE</span> [EXTENDED<span class="operator">|</span>FORMATTED]  </span><br><span class="line">  table_name[.col_name ( [.field_name] <span class="operator">|</span> [.<span class="string">&#x27;$elem$&#x27;</span>] <span class="operator">|</span> [.<span class="string">&#x27;$key$&#x27;</span>] <span class="operator">|</span> [.<span class="string">&#x27;$value$&#x27;</span>] )<span class="operator">*</span> ];</span><br><span class="line"><span class="keyword">DESCRIBE</span> [EXTENDED<span class="operator">|</span>FORMATTED] table_name[.column_name] <span class="keyword">PARTITION</span> partition_spec;</span><br><span class="line">..</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Describe Function</span></span><br><span class="line"><span class="keyword">DESCRIBE</span> <span class="keyword">FUNCTION</span> <span class="operator">&lt;</span>function_name<span class="operator">&gt;</span>;</span><br><span class="line"><span class="keyword">DESCRIBE</span> <span class="keyword">FUNCTION</span> EXTENDED <span class="operator">&lt;</span>function_name<span class="operator">&gt;</span>;</span><br><span class="line">..</span><br></pre></td></tr></table></figure>

<h2 id="4、DML数据操作"><a href="#4、DML数据操作" class="headerlink" title="4、DML数据操作"></a>4、DML数据操作</h2><h3 id="数据导入"><a href="#数据导入" class="headerlink" title="数据导入"></a>数据导入</h3><h4 id="装载数据-LOAD"><a href="#装载数据-LOAD" class="headerlink" title="装载数据 LOAD"></a>装载数据 LOAD</h4><ul>
<li>加载HDFS上的文件到hive表中，采用类似剪切的方式到表的映射目录下</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LOAD DATA [<span class="keyword">LOCAL</span>] INPATH <span class="string">&#x27;filepath&#x27;</span> [OVERWRITE] <span class="keyword">INTO</span> <span class="keyword">TABLE</span> tablename [<span class="keyword">PARTITION</span> (partcol1<span class="operator">=</span>val1, partcol2<span class="operator">=</span>val2 ...)]</span><br><span class="line"> </span><br><span class="line">LOAD DATA [<span class="keyword">LOCAL</span>] INPATH <span class="string">&#x27;filepath&#x27;</span> [OVERWRITE] <span class="keyword">INTO</span> <span class="keyword">TABLE</span> tablename [<span class="keyword">PARTITION</span> (partcol1<span class="operator">=</span>val1, partcol2<span class="operator">=</span>val2 ...)] [INPUTFORMAT <span class="string">&#x27;inputformat&#x27;</span> SERDE <span class="string">&#x27;serde&#x27;</span>] (<span class="number">3.0</span> <span class="keyword">or</span> later)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>Load data</th>
<th>加载数据</th>
</tr>
</thead>
<tbody><tr>
<td>Local</td>
<td>从本地加载数据到hive表，否则是从HDFS加载数据到Hive表</td>
</tr>
<tr>
<td>Inpath</td>
<td>加载数据的路径</td>
</tr>
<tr>
<td>Overwrite</td>
<td>覆盖表中已有数据，否则表示追加</td>
</tr>
<tr>
<td>Into table</td>
<td>加载数据到哪张表中</td>
</tr>
<tr>
<td>Partition</td>
<td>加载数据到指定分区</td>
</tr>
</tbody></table>
<h4 id="插入数据-INSERT"><a href="#插入数据-INSERT" class="headerlink" title="插入数据 INSERT"></a>插入数据 INSERT</h4><ul>
<li>不支持插入部分字段</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> OVERWRITE <span class="keyword">TABLE</span> tablename1 [<span class="keyword">PARTITION</span> (partcol1<span class="operator">=</span>val1, partcol2<span class="operator">=</span>val2 ...) [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>]] select_statement1 <span class="keyword">FROM</span> from_statement;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span> tablename1 [<span class="keyword">PARTITION</span> (partcol1<span class="operator">=</span>val1, partcol2<span class="operator">=</span>val2 ...)] select_statement1 <span class="keyword">FROM</span> from_statement;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>into</th>
<th>以追加数据的方式插入到表或分区，原有数据不会删除</th>
</tr>
</thead>
<tbody><tr>
<td>overwrite</td>
<td>会覆盖表中已存在的数据</td>
</tr>
</tbody></table>
<h4 id="查询结果创建表-As-Select"><a href="#查询结果创建表-As-Select" class="headerlink" title="查询结果创建表 As Select"></a>查询结果创建表 As Select</h4><blockquote>
<p>见数据表操作-创建表</p>
</blockquote>
<h4 id="创建表时加载数据-Location"><a href="#创建表时加载数据-Location" class="headerlink" title="创建表时加载数据 Location"></a>创建表时加载数据 Location</h4><blockquote>
<p>见数据表操作-创建表</p>
</blockquote>
<h3 id="数据导出-INSERT-OVERWRITE"><a href="#数据导出-INSERT-OVERWRITE" class="headerlink" title="数据导出 INSERT OVERWRITE"></a>数据导出 INSERT OVERWRITE</h3><ul>
<li>hive会自动创建导出目录，但是由于是overwrite，所以导出路径一定要写准确，否则存在误删数据的可能</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> OVERWRITE [<span class="keyword">LOCAL</span>] DIRECTORY directory1</span><br><span class="line">  [<span class="type">ROW</span> FORMAT row_format] [STORED <span class="keyword">AS</span> file_format] (Note: <span class="keyword">Only</span> available starting <span class="keyword">with</span> Hive <span class="number">0.11</span><span class="number">.0</span>)</span><br><span class="line">  <span class="keyword">SELECT</span> ... <span class="keyword">FROM</span> ...</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>local</th>
<th>导出到本地，否则导出到HDFS</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="数据迁移-EXPORT-IMPORT"><a href="#数据迁移-EXPORT-IMPORT" class="headerlink" title="数据迁移 EXPORT &#x2F; IMPORT"></a>数据迁移 EXPORT &#x2F; IMPORT</h3><h4 id="导出到HDFS"><a href="#导出到HDFS" class="headerlink" title="导出到HDFS"></a>导出到HDFS</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">EXPORT <span class="keyword">TABLE</span> tablename [<span class="keyword">PARTITION</span> (part_column<span class="operator">=</span>&quot;value&quot;[, ...])] </span><br><span class="line">  <span class="keyword">TO</span> <span class="string">&#x27;export_target_path&#x27;</span> [ <span class="keyword">FOR</span> replication(<span class="string">&#x27;eventid&#x27;</span>) ]</span><br></pre></td></tr></table></figure>

<h4 id="导入到指定Hive"><a href="#导入到指定Hive" class="headerlink" title="导入到指定Hive"></a>导入到指定Hive</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">IMPORT [[<span class="keyword">EXTERNAL</span>] <span class="keyword">TABLE</span> new_or_original_tablename [<span class="keyword">PARTITION</span> (part_column<span class="operator">=</span>&quot;value&quot;[, ...])]] </span><br><span class="line">  <span class="keyword">FROM</span> <span class="string">&#x27;source_path&#x27;</span></span><br><span class="line">  [LOCATION <span class="string">&#x27;import_target_path&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h3 id="数据修复-MSCK"><a href="#数据修复-MSCK" class="headerlink" title="数据修复 MSCK"></a>数据修复 MSCK</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MSCK [REPAIR] <span class="keyword">TABLE</span> table_name [<span class="keyword">ADD</span><span class="operator">/</span><span class="keyword">DROP</span><span class="operator">/</span>SYNC PARTITIONS];</span><br></pre></td></tr></table></figure>

<h2 id="5、UDF函数操作"><a href="#5、UDF函数操作" class="headerlink" title="5、UDF函数操作"></a>5、UDF函数操作</h2><ol>
<li>添加UDF函数jar包</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add</span> jar .<span class="operator">/</span>datas<span class="operator">/</span>myudf.jar;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>创建函数并关联jar包</p>
<ol>
<li><p>临时函数</p>
</li>
<li><pre><code class="SQL">create temporary function my_len as &quot;com.atguigu.hive.MyStringLength&quot;;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">3. 永久函数</span><br><span class="line"></span><br><span class="line">4. ```SQL</span><br><span class="line">   create function my_len2 as &quot;com.atguigu.hive.udf.MyUDF&quot; using jar &quot;hdfs://hadoop102:8020/udf/myudf.jar&quot;;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ol>
</li>
</ol>
<ul>
<li>删除永久函数：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">function</span> my_len2;</span><br></pre></td></tr></table></figure>

<h2 id="6、执行计划"><a href="#6、执行计划" class="headerlink" title="6、执行计划"></a>6、执行计划</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN [EXTENDED <span class="operator">|</span> DEPENDENCY <span class="operator">|</span> <span class="keyword">AUTHORIZATION</span>] query</span><br></pre></td></tr></table></figure>

<h1 id="五、Hive-API"><a href="#五、Hive-API" class="headerlink" title="五、Hive API"></a>五、Hive API</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hive<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hive-exec<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th><strong>常用类</strong></th>
<th><strong>作用</strong></th>
<th><strong>常用参数</strong></th>
<th><strong>常用方法</strong></th>
</tr>
</thead>
<tbody><tr>
<td>org.apache.hadoop.hive.ql.exec.UDFArgumentException</td>
<td>UDF函数异常类</td>
<td></td>
<td></td>
</tr>
<tr>
<td>org.apache.hadoop.hive.ql.exec.UDFArgumentLengthException</td>
<td>UDF函数参数个数异常类</td>
<td></td>
<td></td>
</tr>
<tr>
<td>org.apache.hadoop.hive.ql.exec.UDFArgumentTypeException</td>
<td>UDF函数参数类型异常类</td>
<td></td>
<td></td>
</tr>
<tr>
<td>org.apache.hadoop.hive.ql.metadata.HiveException</td>
<td>Hive异常类</td>
<td></td>
<td></td>
</tr>
<tr>
<td>org.apache.hadoop.hive.ql.udf.generic.GenericUDF</td>
<td>UDF函数接口</td>
<td></td>
<td></td>
</tr>
<tr>
<td>org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector</td>
<td>鉴别器类</td>
<td>返回参数个数：length</td>
<td>返回参数类型：getCategory</td>
</tr>
<tr>
<td>org.apache.hadoop.hive.serde2.objectinspector.primitive.PrimitiveObjectInspectorFactory</td>
<td>类型鉴别器</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h1 id="六、Hive常见配置"><a href="#六、Hive常见配置" class="headerlink" title="六、Hive常见配置"></a>六、Hive常见配置</h1><h2 id="1、hive-site-xml"><a href="#1、hive-site-xml" class="headerlink" title="1、hive-site.xml"></a>1、hive-site.xml</h2><p>可参考</p>
<ol>
<li>默认配置文件：hive-default.xml.template</li>
<li>官方文档：<a target="_blank" rel="noopener" href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties">https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties</a></li>
</ol>
<table>
<thead>
<tr>
<th><strong>常用配置参数</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td>hive.cli.print.header</td>
<td>是否打印当前表头</td>
</tr>
<tr>
<td>hive.cli.print.current.db</td>
<td>是否打印当前库头</td>
</tr>
<tr>
<td>hive.exec.mode.local.auto</td>
<td>是否本地模式</td>
</tr>
<tr>
<td>hive.exec.mode.local.auto.inputbytes.max</td>
<td>local mr的最大输入数据量</td>
</tr>
<tr>
<td>ive.exec.mode.local.auto.input.files.max</td>
<td>local mr的最大输入文件个数</td>
</tr>
<tr>
<td>hive.exec.dynamic.partition</td>
<td>是否开启动态分区</td>
</tr>
<tr>
<td>hive.exec.dynamic.partition.mode</td>
<td>严格模式 | 非严格模式</td>
</tr>
<tr>
<td>hive.exec.max.dynamic.partitions</td>
<td>所有执行MR的节点上，最大可创建的动态分区</td>
</tr>
<tr>
<td>hive.exec.max.dynamic.partitions.pernode</td>
<td>每个执行MR的节点上，最大可创建的动态分区</td>
</tr>
<tr>
<td>hive.exec.max.created.files</td>
<td>整个MR Job中，最大可以创建的HDFS文件</td>
</tr>
<tr>
<td>hive.error.on.empty.partition</td>
<td>当有空分区生成时，是否抛出异常</td>
</tr>
<tr>
<td>hive.exec.compress.intermediate</td>
<td>是否开启hive中间传输数据压缩功能</td>
</tr>
<tr>
<td>mapreduce.job.reduces</td>
<td>分配Reduce的个数（-1为按数据量分配）</td>
</tr>
<tr>
<td>mapreduce.map.output.compress</td>
<td>是否开启mapreduce中map输出压缩功能</td>
</tr>
<tr>
<td>mapreduce.map.output.compress.codec</td>
<td>设置mapreduce中map输出数据的压缩方式（全类名）</td>
</tr>
<tr>
<td>hive.exec.compress.output</td>
<td>开启hive最终输出数据压缩功能</td>
</tr>
<tr>
<td>mapreduce.output.fileoutputformat.compress</td>
<td>开启mapreduce最终输出数据压缩</td>
</tr>
<tr>
<td>mapreduce.output.fileoutputformat.compress.codec</td>
<td>设置mapreduce最终数据输出压缩方式（全类名）</td>
</tr>
<tr>
<td>mapreduce.output.fileoutputformat.compress.type</td>
<td>设置mapreduce最终数据输出压缩方式</td>
</tr>
<tr>
<td>hive.map.aggr</td>
<td>是否在Map端进行聚合</td>
</tr>
<tr>
<td>hive.groupby.mapaggr.checkinterval</td>
<td>在Map端进行聚合操作的条目数目</td>
</tr>
<tr>
<td>hive.groupby.skewindata</td>
<td>有数据倾斜的时候进行负载均衡</td>
</tr>
<tr>
<td>hive.cbo.enable</td>
<td>是否开启CBO</td>
</tr>
<tr>
<td>hive.compute.query.using.stats</td>
<td></td>
</tr>
<tr>
<td>hive.stats.fetch.column.stats</td>
<td></td>
</tr>
<tr>
<td>hive.stats.fetch.partition.stats</td>
<td></td>
</tr>
<tr>
<td>hive.optimize.ppd</td>
<td>是否开启谓词下推</td>
</tr>
<tr>
<td>hive.auto.convert.join</td>
<td>是否自动选择MapJoin</td>
</tr>
<tr>
<td>hive.mapjoin.smalltable.filesize</td>
<td>大表小表的阈值</td>
</tr>
<tr>
<td>hive.optimize.bucketmapjoin</td>
<td>是否开启SMB</td>
</tr>
<tr>
<td>hive.optimize.bucketmapjoin.sortedmerge</td>
<td></td>
</tr>
<tr>
<td>hive.input.format</td>
<td>输入格式（全类名）</td>
</tr>
<tr>
<td>hive.exec.reducers.bytes.per.reducer</td>
<td>每个Reduce处理的数据量</td>
</tr>
<tr>
<td>hive.exec.reducers.max</td>
<td>每个任务最大的reduce数</td>
</tr>
<tr>
<td>hive.skewjoin.key</td>
<td>join记录条数的分拆阈值</td>
</tr>
<tr>
<td>hive.optimize.skewjoin</td>
<td>是否join出现倾斜</td>
</tr>
<tr>
<td>mapreduce.input.fileinputformat.split.maxsize</td>
<td>最大切片值</td>
</tr>
<tr>
<td>hive.merge.mapfiles</td>
<td>是否在map-only任务结束时合并小文件</td>
</tr>
<tr>
<td>hive.merge.mapredfiles</td>
<td>是否在map-reduce任务结束时合并小文件</td>
</tr>
<tr>
<td>hive.merge.size.per.task</td>
<td>合并文件的大小</td>
</tr>
<tr>
<td>hive.merge.smallfiles.avgsize</td>
<td>启动独立map-reduce任务进行文件merge的输出文件平均大小阈值</td>
</tr>
<tr>
<td>hive.map.aggr</td>
<td>是否map端执行combiner</td>
</tr>
<tr>
<td>hive.fetch.task.conversion</td>
<td>Fetch抓取模式</td>
</tr>
<tr>
<td>hive(default)&gt; set</td>
<td>是否开启任务并行</td>
</tr>
<tr>
<td>hive.exec.parallel.thread.number</td>
<td>同一个sql允许最大并行度</td>
</tr>
<tr>
<td>hive.strict.checks.no.partition.filter</td>
<td>严格模式是否不允许分区表不用分区过滤</td>
</tr>
<tr>
<td>hive.strict.checks.orderby.no.limit</td>
<td>严格模式是否不允许order by后没有limit</td>
</tr>
<tr>
<td>hive.strict.checks.cartesian.product</td>
<td>严格模式是否不允许笛卡尔积查询</td>
</tr>
</tbody></table>
<p>表格 还在加载中，请等待加载完成后再尝试复制</p>
<h2 id="2、hive-log4j2-properties"><a href="#2、hive-log4j2-properties" class="headerlink" title="2、hive-log4j2.properties"></a>2、hive-log4j2.properties</h2><blockquote>
<p>需修改文件名：<code>mv conf/hive-log4j2.properties.template conf/hive-log4j2.properties</code></p>
</blockquote>
<table>
<thead>
<tr>
<th><strong>常用配置参数</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td>property.hive.log.dir</td>
<td>log日志文件存放位置</td>
</tr>
</tbody></table>
<h2 id="3、hive-env-sh"><a href="#3、hive-env-sh" class="headerlink" title="3、hive-env.sh"></a>3、hive-env.sh</h2><blockquote>
<p>需修改文件名：<code>mv conf/hive-env.sh.template conf/hive-env.sh</code></p>
</blockquote>
<table>
<thead>
<tr>
<th><strong>常用配置参数</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td>HADOOP_HEAPSIZE</td>
<td>JVM堆内存大小</td>
</tr>
</tbody></table>
<h1 id="附：Hive脚本"><a href="#附：Hive脚本" class="headerlink" title="附：Hive脚本"></a>附：Hive脚本</h1><h2 id="MetaStore-HiveServer2群起"><a href="#MetaStore-HiveServer2群起" class="headerlink" title="MetaStore &amp; HiveServer2群起"></a>MetaStore &amp; HiveServer2群起</h2><p><img src="https://r19unqg14el.feishu.cn/space/api/box/stream/download/asynccode/?code=YTg3ZmY1ZDQyMmNlNGNmZDA1YjZlZDAyODc5M2ZiMDJfajF5ZUZoUWZpcm5Xb0xCZmljaW9YeFBuY2l5azFDcTJfVG9rZW46VkhLbmJkOHRKb3FIOHd4Z3dicmNSVEZNbkdkXzE2ODc1ODMxNzE6MTY4NzU4Njc3MV9WNA" alt="img"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">HIVE_LOG_DIR=<span class="variable">$HIVE_HOME</span>/logs</span><br><span class="line"><span class="keyword">if</span> [ ! -d <span class="variable">$HIVE_LOG_DIR</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="built_in">mkdir</span> -p <span class="variable">$HIVE_LOG_DIR</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment">#检查进程是否运行正常，参数1为进程名，参数2为进程端口</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">check_process</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">    pid=$(ps -ef 2&gt;/dev/null | grep -v grep | grep -i <span class="variable">$1</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">    ppid=$(netstat -nltp 2&gt;/dev/null | grep <span class="variable">$2</span> | awk <span class="string">&#x27;&#123;print $7&#125;&#x27;</span> | <span class="built_in">cut</span> -d <span class="string">&#x27;/&#x27;</span> -f 1)</span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$pid</span></span><br><span class="line">    [[ <span class="string">&quot;<span class="variable">$pid</span>&quot;</span> =~ <span class="string">&quot;<span class="variable">$ppid</span>&quot;</span> ]] &amp;&amp; [ <span class="string">&quot;<span class="variable">$ppid</span>&quot;</span> ] &amp;&amp; <span class="built_in">return</span> 0 || <span class="built_in">return</span> 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">hive_start</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">    metapid=$(check_process HiveMetaStore 9083)</span><br><span class="line">    <span class="comment"># nohup：表示不挂起，关闭终端进程也会继续保持运行状态</span></span><br><span class="line">    <span class="comment"># 文件描述符：</span></span><br><span class="line">    cmd=<span class="string">&quot;nohup hive --service metastore &gt;<span class="variable">$HIVE_LOG_DIR</span>/metastore.log 2&gt;&amp;1 &amp;&quot;</span></span><br><span class="line">    <span class="comment"># /dev/null：linux文件系统中的一个文件，被称为黑洞，所有写入该文件的内容会被自动丢弃</span></span><br><span class="line">    cmd=<span class="variable">$cmd</span><span class="string">&quot; sleep 4; hdfs dfsadmin -safemode wait &gt;/dev/null 2&gt;&amp;1&quot;</span></span><br><span class="line">    [ -z <span class="string">&quot;<span class="variable">$metapid</span>&quot;</span> ] &amp;&amp; <span class="built_in">eval</span> <span class="variable">$cmd</span> || <span class="built_in">echo</span> <span class="string">&quot;MetaStroe服务已启动&quot;</span></span><br><span class="line">    server2pid=$(check_process HiveServer2 10000)</span><br><span class="line">    cmd=<span class="string">&quot;nohup hive --service hiveserver2 &gt;<span class="variable">$HIVE_LOG_DIR</span>/hiveServer2.log 2&gt;&amp;1 &amp;&quot;</span></span><br><span class="line">    [ -z <span class="string">&quot;<span class="variable">$server2pid</span>&quot;</span> ] &amp;&amp; <span class="built_in">eval</span> <span class="variable">$cmd</span> || <span class="built_in">echo</span> <span class="string">&quot;HiveServer2服务已启动&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">hive_stop</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">    metapid=$(check_process HiveMetaStore 9083)</span><br><span class="line">    [ <span class="string">&quot;<span class="variable">$metapid</span>&quot;</span> ] &amp;&amp; <span class="built_in">kill</span> <span class="variable">$metapid</span> || <span class="built_in">echo</span> <span class="string">&quot;Metastore服务未启动&quot;</span></span><br><span class="line">    server2pid=$(check_process HiveServer2 10000)</span><br><span class="line">    [ <span class="string">&quot;<span class="variable">$server2pid</span>&quot;</span> ] &amp;&amp; <span class="built_in">kill</span> <span class="variable">$server2pid</span> || <span class="built_in">echo</span> <span class="string">&quot;HiveServer2服务未启动&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line"><span class="string">&quot;start&quot;</span>)</span><br><span class="line">    hive_start</span><br><span class="line">    ;;</span><br><span class="line"><span class="string">&quot;stop&quot;</span>)</span><br><span class="line">    hive_stop</span><br><span class="line">    ;;</span><br><span class="line"><span class="string">&quot;restart&quot;</span>)</span><br><span class="line">    hive_stop</span><br><span class="line">    <span class="built_in">sleep</span> 2</span><br><span class="line">    hive_start</span><br><span class="line">    ;;</span><br><span class="line"><span class="string">&quot;status&quot;</span>)</span><br><span class="line">    check_process HiveMetaStore 9083 &gt;/dev/null &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;Metastore服务运行正常&quot;</span> || <span class="built_in">echo</span> <span class="string">&quot;Metastore服务运行异常&quot;</span></span><br><span class="line">    check_process HiveServer2 10000 &gt;/dev/null &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;HiveServer2服务运行正常&quot;</span> || <span class="built_in">echo</span> <span class="string">&quot;HiveServer2服务运行异常&quot;</span></span><br><span class="line">    ;;</span><br><span class="line">*)</span><br><span class="line">    <span class="built_in">echo</span> Invalid Args!</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;Usage: &#x27;</span>$(<span class="built_in">basename</span> <span class="variable">$0</span>)<span class="string">&#x27; start|stop|restart|status&#x27;</span></span><br><span class="line">    ;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://wuqiuxu.github.io">吴秋旭</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://wuqiuxu.github.io/%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91%20-%20Hive%E5%AE%9E%E6%93%8D-fd37418ea209/">https://wuqiuxu.github.io/%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91%20-%20Hive%E5%AE%9E%E6%93%8D-fd37418ea209/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://wuqiuxu.github.io" target="_blank">妙妙屋</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Hive/">Hive</a></div><div class="post_share"><div class="social-share" data-image="/img/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91%20-%20Flume%E5%AE%9E%E6%93%8D-030db77e6c7f/" title="数据开发 - Flume实操"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">数据开发 - Flume实操</div></div></a></div><div class="next-post pull-right"><a href="/%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91%20-%20Hadoop%E5%AE%9E%E6%93%8D-f1a482fc8ca6/" title="数据开发 - Hadoop实操"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">数据开发 - Hadoop实操</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">吴秋旭</div><div class="author-info__description">INFJ</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">57</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">29</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Wuqiuxu" target="_blank" title="Github"><i class="fa-brands fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://blog.csdn.net/wufengfeng130?type=blog" target="_blank" title="CSDN"><i class="fa-solid fa-blog" style="color: #FC5531;"></i></a><a class="social-icon" href="https://i.postimg.cc/660kspWH/image.jpg" target="_blank" title="Wechat"><i class="fa-brands fa-weixin" style="color: #05DC6C;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81Hive%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2"><span class="toc-number">1.</span> <span class="toc-text">一、Hive安装部署</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85"><span class="toc-number">1.1.</span> <span class="toc-text">1、下载安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.</span> <span class="toc-text">2、配置文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BF%AE%E6%94%B9core-site-xml"><span class="toc-number">1.2.1.</span> <span class="toc-text">1. 修改core-site.xml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BF%AE%E6%94%B9yarn-site-xml"><span class="toc-number">1.2.2.</span> <span class="toc-text">2. 修改yarn-site.xml</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E5%85%83%E6%95%B0%E6%8D%AE%E9%83%A8%E7%BD%B2"><span class="toc-number">1.3.</span> <span class="toc-text">3、元数据部署</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2Derby"><span class="toc-number">1.3.1.</span> <span class="toc-text">部署Derby</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2MySQL"><span class="toc-number">1.3.2.</span> <span class="toc-text">部署MySQL</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81Hive%E5%90%AF%E5%8A%A8-%E5%81%9C%E6%AD%A2"><span class="toc-number">2.</span> <span class="toc-text">二、Hive启动&#x2F;停止</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81Hive%E6%93%8D%E4%BD%9C"><span class="toc-number">3.</span> <span class="toc-text">三、Hive操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E5%91%BD%E4%BB%A4%E8%A1%8C"><span class="toc-number">3.1.</span> <span class="toc-text">1、命令行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81HiveServer2"><span class="toc-number">3.2.</span> <span class="toc-text">2、HiveServer2</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81Hive%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%93%8D%E4%BD%9C%EF%BC%88HQL%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">四、Hive客户端操作（HQL）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE"><span class="toc-number">4.1.</span> <span class="toc-text">1、数据库配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81DDL-%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89"><span class="toc-number">4.2.</span> <span class="toc-text">2、DDL 数据定义</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="toc-number">4.2.1.</span> <span class="toc-text">数据库操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93-CREATE"><span class="toc-number">4.2.1.1.</span> <span class="toc-text">创建数据库 CREATE</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93-ALTER-SET"><span class="toc-number">4.2.1.2.</span> <span class="toc-text">设置数据库 ALTER .. SET ..</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%87%E6%8D%A2%E6%95%B0%E6%8D%AE%E5%BA%93-USE"><span class="toc-number">4.2.1.3.</span> <span class="toc-text">切换数据库 USE</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93-DROP"><span class="toc-number">4.2.1.4.</span> <span class="toc-text">删除数据库 DROP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="toc-number">4.2.2.</span> <span class="toc-text">数据表操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8-CREATE"><span class="toc-number">4.2.2.1.</span> <span class="toc-text">创建表 CREATE</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%A8-ALTER-TABLE"><span class="toc-number">4.2.2.2.</span> <span class="toc-text">修改表 ALTER TABLE</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E8%A1%A8%E5%B1%9E%E6%80%A7%EF%BC%88set%EF%BC%89"><span class="toc-number">4.2.2.2.1.</span> <span class="toc-text">更新表属性（set）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%87%8D%E5%91%BD%E5%90%8D%E8%A1%A8%EF%BC%88rename-to%EF%BC%89"><span class="toc-number">4.2.2.2.2.</span> <span class="toc-text">重命名表（rename to）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%88%97%EF%BC%88change%EF%BC%89"><span class="toc-number">4.2.2.2.3.</span> <span class="toc-text">更新列（change）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A2%9E%E5%8A%A0-%E6%9B%BF%E6%8D%A2%E5%88%97%EF%BC%88add-replace%EF%BC%89"><span class="toc-number">4.2.2.2.4.</span> <span class="toc-text">增加&#x2F;替换列（add &#x2F; replace）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B8%85%E7%A9%BA%E8%A1%A8%EF%BC%88truncate%EF%BC%89"><span class="toc-number">4.2.2.2.5.</span> <span class="toc-text">清空表（truncate）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%A1%A8%EF%BC%88drop%EF%BC%89"><span class="toc-number">4.2.2.2.6.</span> <span class="toc-text">删除表（drop）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%88%86%E5%8C%BA"><span class="toc-number">4.2.2.2.7.</span> <span class="toc-text">修改分区</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%A1%A8-SELECT"><span class="toc-number">4.2.2.3.</span> <span class="toc-text">查询表 SELECT</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Show"><span class="toc-number">4.2.3.</span> <span class="toc-text">Show</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Describe"><span class="toc-number">4.2.4.</span> <span class="toc-text">Describe</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81DML%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C"><span class="toc-number">4.3.</span> <span class="toc-text">4、DML数据操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5"><span class="toc-number">4.3.1.</span> <span class="toc-text">数据导入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A3%85%E8%BD%BD%E6%95%B0%E6%8D%AE-LOAD"><span class="toc-number">4.3.1.1.</span> <span class="toc-text">装载数据 LOAD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE-INSERT"><span class="toc-number">4.3.1.2.</span> <span class="toc-text">插入数据 INSERT</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%E5%88%9B%E5%BB%BA%E8%A1%A8-As-Select"><span class="toc-number">4.3.1.3.</span> <span class="toc-text">查询结果创建表 As Select</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%97%B6%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE-Location"><span class="toc-number">4.3.1.4.</span> <span class="toc-text">创建表时加载数据 Location</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA-INSERT-OVERWRITE"><span class="toc-number">4.3.2.</span> <span class="toc-text">数据导出 INSERT OVERWRITE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB-EXPORT-IMPORT"><span class="toc-number">4.3.3.</span> <span class="toc-text">数据迁移 EXPORT &#x2F; IMPORT</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%87%BA%E5%88%B0HDFS"><span class="toc-number">4.3.3.1.</span> <span class="toc-text">导出到HDFS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E5%88%B0%E6%8C%87%E5%AE%9AHive"><span class="toc-number">4.3.3.2.</span> <span class="toc-text">导入到指定Hive</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BF%AE%E5%A4%8D-MSCK"><span class="toc-number">4.3.4.</span> <span class="toc-text">数据修复 MSCK</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81UDF%E5%87%BD%E6%95%B0%E6%93%8D%E4%BD%9C"><span class="toc-number">4.4.</span> <span class="toc-text">5、UDF函数操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92"><span class="toc-number">4.5.</span> <span class="toc-text">6、执行计划</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81Hive-API"><span class="toc-number">5.</span> <span class="toc-text">五、Hive API</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81Hive%E5%B8%B8%E8%A7%81%E9%85%8D%E7%BD%AE"><span class="toc-number">6.</span> <span class="toc-text">六、Hive常见配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81hive-site-xml"><span class="toc-number">6.1.</span> <span class="toc-text">1、hive-site.xml</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81hive-log4j2-properties"><span class="toc-number">6.2.</span> <span class="toc-text">2、hive-log4j2.properties</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81hive-env-sh"><span class="toc-number">6.3.</span> <span class="toc-text">3、hive-env.sh</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%99%84%EF%BC%9AHive%E8%84%9A%E6%9C%AC"><span class="toc-number">7.</span> <span class="toc-text">附：Hive脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MetaStore-HiveServer2%E7%BE%A4%E8%B5%B7"><span class="toc-number">7.1.</span> <span class="toc-text">MetaStore &amp; HiveServer2群起</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('/img/default.png')"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024 By 吴秋旭</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.22.1/dist/algoliasearch-lite.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.65.0/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js?v=4.13.0"></script></div></div></body></html>